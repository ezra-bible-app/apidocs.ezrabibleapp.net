

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ezra Bible App Design Docs frontend/components/tags/tag_selection_menu.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="style.css">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
             
                <a href="index.html">
                    <h1 class="navbar-item">Ezra Bible App Design Documentation</h1>
                </a>
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    API Documentation
                </a>
                
                 
                    
                        <a
                            class="link user-link "
                            href="https://github.com/ezra-bible-app/ezra-bible-app"
                        >
                            GitHub repo
                        </a>
                    
                        <a
                            class="link user-link "
                            href="https://ezrabibleapp.net"
                        >
                            Project website
                        </a>
                    
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="CordovaPlatform.html">CordovaPlatform</a></li><li><a href="ElectronPlatform.html">ElectronPlatform</a></li><li><a href="HierarchicalObjectCache.html">HierarchicalObjectCache</a></li><li><a href="ItemListManager.html">ItemListManager</a></li><li><a href="TagGroupAssignmentList.html">TagGroupAssignmentList</a></li><li><a href="TagGroupList.html">TagGroupList</a></li><li><a href="TagGroupManager.html">TagGroupManager</a></li><li><a href="TagList.html">TagList</a></li><li><a href="TagListMenu.html">TagListMenu</a></li><li><a href="TagManager.html">TagManager</a></li><li><a href="TextField.html">TextField</a></li></ul><h3>Global</h3><ul><li><a href="global.html#clearLongPressTimer">clearLongPressTimer</a></li><li><a href="global.html#crypto">crypto</a></li><li><a href="global.html#getCachedItem">getCachedItem</a></li><li><a href="global.html#getLanguageCode">getLanguageCode</a></li><li><a href="global.html#handleTouchMove">handleTouchMove</a></li><li><a href="global.html#listCheckboxSection">listCheckboxSection</a></li><li><a href="global.html#startTimer">startTimer</a></li><li><a href="global.html#subscribe">subscribe</a></li></ul></div><div class="category"><h2>Component</h2><h3>Modules</h3><ul><li><a href="module-ModuleAssistant.html">ModuleAssistant</a></li><li><a href="module-StepLanguages.html">StepLanguages</a></li><li><a href="module-StepModules.html">StepModules</a></li><li><a href="module-StepModulesRemove.html">StepModulesRemove</a></li><li><a href="module-StepRepositories.html">StepRepositories</a></li></ul><h3>Classes</h3><ul><li><a href="AssignLastTagButton.html">AssignLastTagButton</a></li><li><a href="BookSelectionMenu.html">BookSelectionMenu</a></li><li><a href="CommentaryPanel.html">CommentaryPanel</a></li><li><a href="DictionaryInfoBox.html">DictionaryInfoBox</a></li><li><a href="DocxExport.html">DocxExport</a></li><li><a href="EmojiButtonTrigger.html">EmojiButtonTrigger</a></li><li><a href="NavigationPane.html">NavigationPane</a></li><li><a href="OptionsMenu.html">OptionsMenu</a></li><li><a href="SwordNotes.html">SwordNotes</a></li><li><a href="TabSearch.html">TabSearch</a></li><li><a href="TagListFilter.html">TagListFilter</a></li><li><a href="TagSelectionMenu.html">TagSelectionMenu</a></li><li><a href="TextSizeSettings.html">TextSizeSettings</a></li><li><a href="TranslationComparison.html">TranslationComparison</a></li><li><a href="VerseListPopup.html">VerseListPopup</a></li><li><a href="VerseSelection.html">VerseSelection</a></li><li><a href="VerseStatisticsChart.html">VerseStatisticsChart</a></li></ul></div><div class="category"><h2>Controller</h2><h3>Modules</h3><ul><li><a href="module-dbSyncController.html">dbSyncController</a></li><li><a href="module-eventController.html">eventController</a></li><li><a href="module-fullscreenController.html">fullscreenController</a></li><li><a href="module-i18nController.html">i18nController</a></li><li><a href="module-moduleUpdateController.html">moduleUpdateController</a></li><li><a href="module-referenceVerseController.html">referenceVerseController</a></li><li><a href="module-verseListController.html">verseListController</a></li><li><a href="module-wheelnavController.html">wheelnavController</a></li></ul><h3>Classes</h3><ul><li><a href="AppController.html">AppController</a></li><li><a href="DictionaryController.html">DictionaryController</a></li><li><a href="ModuleSearchController.html">ModuleSearchController</a></li><li><a href="NotesController.html">NotesController</a></li><li><a href="TabController.html">TabController</a></li><li><a href="TagsController.html">TagsController</a></li><li><a href="TextController.html">TextController</a></li><li><a href="ThemeController.html">ThemeController</a></li><li><a href="TranslationController.html">TranslationController</a></li></ul><h3>Global</h3><ul><li><a href="global.html#generateDocument">generateDocument</a></li><li><a href="global.html#saveWordDocument">saveWordDocument</a></li></ul></div><div class="category"><h2>Helper</h2><h3>Modules</h3><ul><li><a href="module-sword_module_helper.html">sword_module_helper</a></li><li><a href="module-verse_list_title_helper.html">verse_list_title_helper</a></li></ul></div><div class="category"><h2>Model</h2><h3><a href="global.html">Global</a></h3></div><div class="category"><h2>Startup</h2><h3>Modules</h3><ul><li><a href="module-ezra_init.html">ezra_init</a></li><li><a href="module-platform_init.html">platform_init</a></li></ul><h3>Classes</h3><ul><li><a href="Startup.html">Startup</a></li></ul></div><div class="category"><h2>Utility</h2><h3>Modules</h3><ul><li><a href="module-emojiHelper.html">emojiHelper</a></li><li><a href="module-ezraHelper.html">ezraHelper</a></li><li><a href="module-fsHelper.html">fsHelper</a></li><li><a href="module-i18NHelper.html">i18NHelper</a></li><li><a href="module-languageMapper.html">languageMapper</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>frontend/components/tags/tag_selection_menu.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* This file is part of Ezra Bible App.

   Copyright (C) 2019 - 2023 Ezra Bible App Development Team &lt;contact@ezrabibleapp.net>

   Ezra Bible App is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 2 of the License, or
   (at your option) any later version.

   Ezra Bible App is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with Ezra Bible App. See the file LICENSE.
   If not, see &lt;http://www.gnu.org/licenses/>. */

const { waitUntilIdle } = require('../../helpers/ezra_helper.js');
const eventController = require('../../controllers/event_controller.js');

/**
 * The TagSelectionMenu component implements the menu for selecting a tagged verse list.
 * 
 * @category Component
 */
class TagSelectionMenu {
  constructor() {
    this.tag_menu_is_opened = false;
    this.tag_menu_populated = false;
    this.currentTagGroupId = -1;

    this.bindUserEvents();
    this.subscribeAppEvents();
  }

  bindUserEvents() {
    $('#tag-selection-filter-input').bind('keyup', () => { this.handleTagSearchInput(); });

    // eslint-disable-next-line no-unused-vars
    $('#tag-selection-recently-used-checkbox').bind('click', (event) => {
      this.applyCurrentFilters();
    });

    $('#select-all-tags-button').bind('click', () => {
      this.selectAllTags();
    });

    $('#deselect-all-tags-button').bind('click', () => {
      this.deselectAllTags();
    });

    $('#confirm-tag-selection-button').bind('click', () => {
      this.handleConfirmButtonClick();
    });

    $('#tagSelectionBackButton').bind('click', () => {
      setTimeout(() => { this.hideTagMenu(); }, 100);
    });
  }

  subscribeAppEvents() {
    eventController.subscribe('on-tab-added', (tabIndex) => {
      this.initForTab(tabIndex);
    });

    eventController.subscribeMultiple(['on-tag-created', 'on-tag-deleted'], async () => {
      await this.requestTagsForMenu(this.currentTagGroupId, true);
    });

    eventController.subscribe('on-tag-renamed', async() => {
      await this.requestTagsForMenu(this.currentTagGroupId);
    });

    eventController.subscribe('on-tag-selection-menu-group-list-activated', () => {
      this.getTagListContainer()[0].style.display = 'none';
      document.getElementById('tag-selection-filter-buttons').style.display = 'none';
      document.getElementById('tag-selection-filter').style.display = 'none';
      document.getElementById('tag-selection-summary').style.display = 'none';
      document.getElementById('tag-selection-menu-tag-group-list').style.removeProperty('display');
    });

    eventController.subscribe('on-tag-selection-menu-group-selected', async (tagGroup) => {
      this.showTagGroup(tagGroup.id);
    });
  }

  initForTab(tabIndex=undefined) {
    var currentVerseListMenu = app_controller.getCurrentVerseListMenu(tabIndex);
    currentVerseListMenu.find('.tag-select-button').bind('click', (event) => { this.handleTagMenuClick(event); });
  }

  hideTagGroupList() {
    document.getElementById('tag-selection-menu-tag-group-list').style.display = 'none';
  }

  async showTagGroup(tagGroupId) {
    this.hideTagGroupList();

    this.currentTagGroupId = tagGroupId;
    await this.requestTagsForMenu(this.currentTagGroupId);
    await this.updateTagSelectionMenu();

    this.showTagListUi();
  }

  showTagListUi() {
    this.getTagListContainer()[0].style.removeProperty('display');
    document.getElementById('tag-selection-filter-buttons').style.display = 'flex';
    document.getElementById('tag-selection-filter').style.removeProperty('display');
    document.getElementById('tag-selection-summary').style.display = 'flex';
  }

  selectAllTags() {
    var tagListContainer = this.getTagListContainer()[0];
    tagListContainer.querySelectorAll('.tag-browser-tag-cb').forEach((cb) => { cb.checked = true; });
    this.handleTagSelection();

    var selectAllButton = document.getElementById('select-all-tags-button');
    selectAllButton.classList.add('ui-state-disabled');
  }

  deselectAllTags() {
    var tagListContainer = this.getTagListContainer()[0];
    tagListContainer.querySelectorAll('.tag-browser-tag-cb').forEach((cb) => { cb.checked = false; });
    this.handleTagSelection();

    var selectAllButton = document.getElementById('select-all-tags-button');
    selectAllButton.classList.remove('ui-state-disabled');
  }

  getTagListContainer() {
    return $('#tag-selection-taglist-global');
  }

  applyCurrentFilters() {
    this.showAllTags();
    
    this.applyTagSearchFilter();

    if ($('#tag-selection-recently-used-checkbox').prop('checked') == true) {
      this.filterRecentlyUsed();
    }
  }

  filterRecentlyUsed() {
    var tagListContainer = this.getTagListContainer();

    tagListContainer.find('.tag-browser-tag').filter(function() {
      return tags_controller.tag_store.filterRecentlyUsedTags(this);
    }).hide();
  }

  showAllTags() {
    var tagListContainer = this.getTagListContainer();
    tagListContainer.find('.tag-browser-tag').show();
  }

  async hideTagMenu() {
    if (this.tag_menu_is_opened) {
      document.getElementById('tag-selection-menu').style.display = 'none';
      document.getElementById('app-container').classList.remove('fullscreen-menu');

      let groupList = document.getElementById('tag-selection-menu-tag-group-list');
      let currentGroup = await groupList.tagGroupManager.getItemById(this.currentTagGroupId);

      eventController.publishAsync('on-tag-selection-menu-group-selected', currentGroup);

      var tag_button = $('#app-container').find('.tag-select-button');
      tag_button.removeClass('ui-state-active');

      this.tag_menu_is_opened = false;
    }
  }

  async handleTagMenuClick(event) {
    var currentVerseListMenu = app_controller.getCurrentVerseListMenu();
    var tagSelectButton = currentVerseListMenu.find('.tag-select-button');

    if (tagSelectButton.hasClass('ui-state-disabled')) {
      return;
    }

    if (this.tag_menu_is_opened) {
      app_controller.handleBodyClick();
    } else {
      app_controller.hideAllMenus();

      document.getElementById('app-container').classList.add('fullscreen-menu');

      tagSelectButton.addClass('ui-state-active');
      var tag_select_button_offset = tagSelectButton.offset();

      var menu = $('#app-container').find('#tag-selection-menu');
      var tagList = $('#app-container').find('#tag-selection-taglist-global');
      var tagListOverlay = $('#app-container').find('#tag-selection-taglist-overlay');

      var top_offset = tag_select_button_offset.top + tagSelectButton.height() + 1;
      var left_offset = tag_select_button_offset.left;

      menu.css('top', top_offset);
      menu.css('left', left_offset);

      // Show an overlay while the actual menu is rendering
      tagList.hide();
      tagListOverlay.css('display', 'flex');
      tagListOverlay.find('.loader').show();
      menu.show();

      await waitUntilIdle();
      await this.updateTagSelectionMenu();

      tagList.show();
      tagListOverlay.hide();
      this.showTagListUi();

      uiHelper.configureButtonStyles('#tag-selection-menu');

      if (platformHelper.isElectron()) {
        // We're only focussing the search filter on Electron, because on Android it would trigger the screen keyboard right away
        // and that would be disturbing from a usability perspective.
        $('#tag-selection-filter-input').select();
      }

      this.tag_menu_is_opened = true;
      event.stopPropagation();
    }
  }

  async requestTagsForMenu(tagGroupId=null, forceRefresh=false) {
    var tags = await tags_controller.getTagList(forceRefresh);

    if (tagGroupId != null &amp;&amp; tagGroupId > 0) {
      tags = await tags_controller.tag_store.getTagGroupMembers(tagGroupId, tags);
    }

    this.renderTagsInMenu(tags);
    this.tag_menu_populated = true;
  }

  renderTagsInMenu(tags) {
    this.resetTagsInMenu();

    if (tags.length > 50) {
      document.getElementById('select-all-tags-button').style.display = 'none';
    } else {
      document.getElementById('select-all-tags-button').style.removeProperty('display');
    }

    var taglist_container = this.getTagListContainer();
    this.renderTagList(tags, taglist_container, false);
    this.bindClickToCheckboxLabels();
  }

  bindClickToCheckboxLabels() {
    $('.clickable-checkbox-label:not(.events-configured)').bind('click', function() {
      var closest_input = $(this).prevAll('input:first');

      if (closest_input.attr('type') == 'checkbox') {
        closest_input[0].click();
      }
    }).addClass('events-configured');
  }

  renderTagList(tag_list, target_container, only_local) {
    var target_element = target_container[0];
    var all_tags_html = "";

    for (var i = 0; i &lt; tag_list.length; i++) {
      var current_tag = tag_list[i];
      var current_tag_title = current_tag.title;
      var current_tag_id = current_tag.id;
      var current_book_id = current_tag.bibleBookId;
      var current_assignment_count = current_tag.globalAssignmentCount;
      var current_tag_last_used = current_tag.lastUsed;

      if (only_local &amp;&amp; (current_book_id == null)) {
        continue;
      }

      var current_tag_html = this.getHtmlForTag(current_tag_id,
                                                current_tag_title,
                                                current_assignment_count,
                                                current_tag_last_used);
      all_tags_html += current_tag_html;
    }

    target_element.innerHTML = all_tags_html;
    this.initTagCBs();
  }

  updateCheckedTags(target_container) {
    var selected_tag_list = this.getSelectedTagList();

    // Check all the previously selected tags in the list
    var all_tags = target_container[0].querySelectorAll('.tag-browser-tag-title-content');
    
    for (var i = 0; i &lt; all_tags.length; i++) {
      var current_tag = all_tags[i];

      var current_tag_is_checked = false;
      if (selected_tag_list !== null) {
        current_tag_is_checked = selected_tag_list.includes(current_tag.textContent);
      }

      var tag_browser_tag = current_tag.closest('.tag-browser-tag');
      var tag_cb = tag_browser_tag.querySelector('.tag-browser-tag-cb'); 

      if (current_tag_is_checked) {
        tag_cb.checked = true;
      } else {
        tag_cb.checked = false;
      }
    }
  }

  getHtmlForTag(tag_id, tag_title, tag_assignment_count, tag_last_used) {
    return "&lt;div id='tag-browser-tag-" + tag_id + 
           "' class='tag-browser-tag' last-used-timestamp='" + tag_last_used + "'>" + 
           "&lt;div class='tag-browser-tag-id'>" + tag_id + "&lt;/div>" +
           "&lt;input class='tag-browser-tag-cb' type='checkbox'>&lt;/input>" +
           "&lt;div class='tag-browser-tag-title clickable-checkbox-label'>" +
           "&lt;span class='tag-browser-tag-title-content'>" + tag_title + "&lt;/span>" +
           "&lt;span class='tag-browser-tag-assignment-count'>(" + tag_assignment_count + ")&lt;/span>" +
           "&lt;/div>" +
           "&lt;/div>";
  }

  applyTagSearchFilter() {
    //console.time('filter-tag-list');
    
    var search_value = $('#tag-selection-filter-input').val();
    var tagListContainer = this.getTagListContainer();

    var labels = tagListContainer.find('.tag-browser-tag-title-content');
    tagListContainer.find('.tag-browser-tag').hide();

    for (var i = 0; i &lt; labels.length; i++) {
      var current_label = $(labels[i]);

      if (current_label.text().toLowerCase().indexOf(search_value.toLowerCase()) != -1) {
        var current_tag_box = current_label.closest('.tag-browser-tag');
        current_tag_box.show();
      }
    }
    //console.timeEnd('filter-tag-list');
  }

  handleTagSearchInput() {
    clearTimeout(this.tag_search_timeout);
    this.tag_search_timeout = setTimeout(() => { this.applyCurrentFilters(); }, 300);
  }

  resetTagsInMenu() {
    var taglist_container = this.getTagListContainer();
    while (taglist_container.firstChild) {
      taglist_container.removeChild(taglist_container.firstChild);
    }
  }

  getSelectedTagList() {
    var currentTab = app_controller.tab_controller.getTab();
    var currentTagIdList = currentTab.getTagIdList();
    var currentTextType = currentTab.getTextType();
    
    if (currentTextType == 'tagged_verses' &amp;&amp; currentTagIdList != null) {
      var currentTagTitleList = app_controller.tab_controller.getTab().getTagTitleList();
      if (currentTagTitleList != null) {
        var tag_list = currentTagTitleList.split(', ');
        return tag_list;
      }
    }

    return null;
  }

  selectedTagIds() {
    var checked_cbs = $('.tag-browser-tag-cb:checked');
    var tag_list = "";

    for (var i = 0; i &lt; checked_cbs.length; i++) {
      var current_tag_id = $(checked_cbs[i]).closest('.tag-browser-tag').find('.tag-browser-tag-id').html();
      tag_list += current_tag_id;

      if (i &lt; (checked_cbs.length - 1)) tag_list += ",";
    }

    return tag_list;
  }

  selectedTagTitles() {
    var checked_cbs = $('.tag-browser-tag-cb:checked');
    var tag_list = "";

    for (var i = 0; i &lt; checked_cbs.length; i++) {
      var current_tag_title = $(checked_cbs[i]).closest('.tag-browser-tag').find('.tag-browser-tag-title-content').text();
      tag_list += current_tag_title;

      if (i &lt; (checked_cbs.length - 1)) tag_list += ", ";
    }

    return tag_list;
  }

  async handleConfirmButtonClick() {
    this.hideTagMenu();
    var currentTagIdList = this.selectedTagIds();
    var currentTagTitleList = this.selectedTagTitles();
    app_controller.openTaggedVerses(currentTagIdList, currentTagTitleList);
  }

  handleTagSelection() {
    var tagCountSelectedLabel = document.getElementById('tag-count-selected-label');
    var confirmButton = document.getElementById('confirm-tag-selection-button');
    var deselectAllButton = document.getElementById('deselect-all-tags-button');
    var selectAllButton = document.getElementById('select-all-tags-button');
    var currentTagIdList = this.selectedTagIds();
    var currentTagTitleList = this.selectedTagTitles();
    var selectedTagCount = 0;
   
    if (currentTagIdList != "") { 
      selectedTagCount = currentTagIdList.split(',').length;
    }

    var taglistContainer = this.getTagListContainer();
    var tagList = taglistContainer[0].querySelectorAll('.tag-browser-tag');

    if (selectedTagCount == tagList.length) {
      selectAllButton.classList.add('ui-state-disabled');
    } else {
      selectAllButton.classList.remove('ui-state-disabled');
    }

    if (selectedTagCount > 0) {
      confirmButton.classList.remove('ui-state-disabled');
      deselectAllButton.classList.remove('ui-state-disabled');
    } else {
      confirmButton.classList.add('ui-state-disabled');
      deselectAllButton.classList.add('ui-state-disabled');
    }

    var tagCountLabelText = i18n.t('tags.tag-count-selected', { count: selectedTagCount });
    tagCountSelectedLabel.textContent = tagCountLabelText;
    tagCountSelectedLabel.setAttribute('title', currentTagTitleList);
  }

  initTagCBs() {
    var cbs = document.querySelectorAll('.tag-browser-tag-cb');
    for (var i = 0; i &lt; cbs.length; i++) {
      cbs[i].addEventListener('click', async () => { 
        this.handleTagSelection(); 
      });

      cbs[i].removeAttribute('checked');
      cbs[i].removeAttribute('disabled');
    }
  }
  
  resetTagMenu() {
    var taglist_container = this.getTagListContainer();
    var tag_cb_list = taglist_container[0].querySelectorAll('.tag-browser-tag-cb');

    for (var i = 0; i &lt; tag_cb_list.length; i++) {
      tag_cb_list[i].checked = false;
    }
  }

  // eslint-disable-next-line no-unused-vars
  async updateTagSelectionMenu() {
    if (!this.tag_menu_populated) {
      await this.requestTagsForMenu();
    }

    var taglist_container = this.getTagListContainer();
    this.updateCheckedTags(taglist_container);
    
    this.applyCurrentFilters();
    this.handleTagSelection();
  }

  updateVerseCountInTagMenu(tag_title, new_count) {
    var tag_list = $('.tag-browser-tag');

    for (var i = 0; i &lt; tag_list.length; i++) {
      var current_tag = $(tag_list[i]).find('.tag-browser-tag-title-content').text();
      if (current_tag == tag_title) {
        $(tag_list[i]).find('.tag-browser-tag-assignment-count').text('(' + new_count + ')');
        break;
      }
    }
  }

  updateLastUsedTimestamp(tagId, timestamp) {
    var tagElement = $('#tag-browser-tag-' + tagId);
    tagElement.attr('last-used-timestamp', timestamp);
  }
}

module.exports = TagSelectionMenu;
</code></pre>
        </article>
    </section>




            </div>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

</body>
</html>
